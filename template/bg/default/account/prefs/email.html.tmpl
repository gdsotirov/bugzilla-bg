[%# 1.0@bugzilla.org %]
[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the Bugzilla Bug Tracking System.
  #
  # The Initial Developer of the Original Code is Netscape Communications
  # Corporation. Portions created by Netscape are
  # Copyright (C) 1998 Netscape Communications Corporation. All
  # Rights Reserved.
  #
  # Contributor(s): Gervase Markham <gerv@gerv.net>
  #                 Myk Melez <myk@mozilla.org>
  #                 Shane H. W. Travis <travis@sedsystems.ca>
  #%]

[%# INTERFACE:
  # watchedusers: string.
  #               Comma-separated list of email addresses this user watches.
  # excludeself:  boolean.
  #               True if user is not receiving self-generated mail.
  # <rolename>:   Multiple hashes, one for each rolename (e.g. owner; see
  #               below), keyed by reasonname (e.g. comments; again, see
  #               below). The value is a boolean - true if the user is
  #               receiving mail for that reason when in that role.
  # Also references the 'supportwatchers' Param.
  #%]

[% PROCESS global/variables.none.tmpl %]

[% useqacontact = Param('useqacontact') %]
[% usevotes = Param('usevotes') %]

<table>
  [% IF Param('supportwatchers') %]
    <tr>
      <td colspan="4">
        <hr>
      </td>
    </tr>

    <tr>
      <td colspan="4">
        Ако желаете да поемете работата на някои, когато са в почивка или ако
        трябва да направите качествен контрл свързан с всичките им [% terms.bugs %], можете да укажете
        на [%+ terms.Bugzilla %] да изпраща поща свързана с техните [% terms.bugs %] към вас също. Направете списък
        с е-пощенските адреси на всички регистрации които искате да наблюдавате, разделени със 
        запетаии.
      </td>
    </tr>

    <tr>
      <th align="right">Потребители за наблюдение:</th>
      <td>
        <input size="35" name="watchedusers" 
               value="[% watchedusers FILTER html %]">
      </td>
    </tr>
  [% END %]

  <tr>
    <td colspan="2">
      <p>
        Ако не желаете да получавате известие за "несъществени"
        промени по [% terms.bugs %], можете да използвате настрйките по-долу, за да
        прецедите някои (или дори всички) известия.
      </p>
    </td>
  </tr>
</table>

<hr>

<table>
  <tr>
    <td colspan="2">
      <b>Общ избор:</b>
    </td>
  </tr>

  <tr>
    <td width="150"></td>
    <td>
      <input type="checkbox" name="ExcludeSelf" id="ExcludeSelf" value="on"
        [% " checked" IF excludeself %]>
      <label for="ExcludeSelf">Докладване само на промени направени от други хора</label>
      <br>
    </td>
  </tr>
  <tr>
    <td width="150"></td>
    <td>
      <input type="checkbox" name="FlagRequestee" id="FlagRequestee" value="on"
        [% " checked" IF FlagRequestee %]>
      <label for="FlagRequestee">Известяване, когато някой поиска да задам флаг</label>
      <br>
    </td>
  </tr>
  <tr>
    <td width="150"></td>
    <td>
      <input type="checkbox" name="FlagRequester" id="FlagRequester" value="on"
        [% " checked" IF FlagRequester %]>
      <label for="FlagRequester">Известяване, когато някой зададе флаг поискан от мен</label>
      <br>
    </td>
  </tr>
</table>
<noscript>Ако имахте действуваш Javascript, щяхте да можете да задавате всички тези с едно натискане.<br></noscript>
<script type="text/javascript">
<!--
function SetCheckboxes(setting) {
  for (var count = 0; count < document.userprefsform.elements.length; count++) {
    var theinput = document.userprefsform.elements[count];
    if (theinput.type == "checkbox") {
      if (theinput.name == "ExcludeSelf") {
        theinput.checked = false;
      }
      else {
        theinput.checked = setting;
      }
    }
  }
}

document.write('<input type="button" value="Разрешаване на всичката поща" onclick="SetCheckboxes(true); return false;">\n');
document.write('<input type="button" value="Забраняване на всичката поща" onclick="SetCheckboxes(false); return false;">\n');
// -->
</script>
<hr>
<b>Избор по поле/получател:</b>
<br>
<br>


<table width="100%" border="1">
  <tr>
    <td colspan="[% (useqacontact AND usevotes) ? '5' : ((useqacontact OR usevotes) ? '4' : '3') %]" align="center" width="50%">
      <b>Когато връзката ми с този [% terms.bug %] е:</b>
    </td>
    <td rowspan="2" width="50%">
      <b>Желая да получавам поща, когато:</b>
    </td>
  </tr>

  <tr>
    <td align="center" width="10%">
      <b>Докладчик</b>
    </td>
    <td align="center" width="10%">
      <b>Назначен</b>
    </td>
    [% IF useqacontact %]
      <td align="center" width="10%">
        <b>Качествен контрол</b>
      </td>
    [% END %]
    <td align="center" width="10%">
      <b>Съм в списъка <abbr title="Точно Копие">ТК</abbr></b>
    </td>
    [% IF usevotes %]
      <td align="center" width="10%">
        <b>Гласувал</b>
      </td>
    [% END %]
  </tr>

[% bugLabelLower = BLOCK %]
[% terms.bug %]
[% END %]

  [% FOREACH reason = [
      { name = 'Removeme',
        description = "Съм дбавян или премахван от тази длъжност" },
      { name = 'Comments',
        description = "Са добавени нови коментари" },
      { name = 'Attachments',
        description = "Са добавени нови приставки" },
      { name = 'Status',
        description = "Се променят приоритет, състояние, суровост или цел" },
      { name = 'Resolved',
        description = "Бъга ${bugLabelLower} е разрешен или потвърден" },
      { name = 'Keywords',
        description = "Се промени полето с ключови думи" },
      { name = 'CC',
        description = "Се промени полето <abbr title="Точно Копие">CC</abbr>" },
      { name = 'Other',
        description = "Се промени всяко друго поле неспоменато горе" },
      { name = 'Unconfirmed',
        description = "Бъга ${bugLabelLower} е в непотвърдено състояние" },
  ] %]
    <tr>
      [% FOREACH role = [ "Reporter", "Owner", "QAcontact", "CClist", "Voter" ]
       %]
        [% NEXT IF role == "QAcontact" AND NOT useqacontact %]
        [% NEXT IF role == "Voter" AND NOT usevotes %]
        <td align="center">
          <input type="checkbox" name="email[% role %][% reason.name %]" value="on"
            [% " checked" IF $role.${reason.name} %]>
        </td>
      [% END %]
      <td>
        [% reason.description %]
      </td>
    </tr>
  [% END %]
</table>

<br>
